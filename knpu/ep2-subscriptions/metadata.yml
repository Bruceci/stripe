title: Stripe Level 2: Subscriptions, Discounts, Webhooks, oh my!

summary: |
    After [Part 1](http://knpuniversity.com/screencast/stripe) of the tutorial,
    you are *rocking* with Stripe: Charges, Customer, Invoices and error-handling
    are old news.

    Now it's time to take our sheep-shearing startup to the next level: by offering
    a monthly subscription service. Woh.

    - Learn to create and charge subscriptions!
    - Store the card type and last 4 to show your user
    - Update a customer's credit card
    - Handle cancellations... and reactivations!
    - Use web-hooks to handle renewal payments, cancellation, payment failures
    - Upgrading/Downgrading a subscription *correctly* with prorations
    - Offer Coupons and even free subscriptions to awesome people!
    - Giving your user's high-quality invoices

    Oh, the possibilities are endless: create a subscription service that treats
    your customers right.

illustration: stripe2.png

tuts_hero:
    start_step: subscription-prep-user-entity-changes
    finish_step: invoice-render-single-invoice

chapters:
    creating-plans:
        is_free:   true
        video_key: 180641715
    add-plan-to-cart:
        is_free:   true
        video_key: 180643039
    make-the-subscription:
        is_free:   true
        video_key: 180644777
    user-has-subscription:
        is_free:   true
        video_key: 180647158
    card-last4:
        video_key: 180648342
    billing-periods-ends-at:
        video_key: 180661092
    canceling-stripe-subscription:
        video_key: 181228865
    canceling-on-our-site:
        video_key: 181230231
    reactivate-subscription:
        video_key: 181231228
    cancelation-edge-case-bugs:
        video_key: 181231424
    update-card-form:
        video_key: 182593499
    update-card-processing:
        video_key: 182596162
    card-update-failure:
        video_key: 182594657
    stripe-events-webhook:
        video_key: 182595452
    webhook-endpoint-setup:
        video_key: 182596342
    subscription-canceled-webhook:
        video_key: 182601300
    testing-webhooks:
        video_key: 182602437
    testing-webhooks-fake-event:
        video_key: 182621794
    live-webhook-testing-ngrok:
        video_key: 182620777
    subscription-renewal-webhook:
        video_key: 182623409
    payment-failed-webhook:
        is_finished: false
        video_key: ~
    replay-attacks:
        is_finished: false
        video_key: ~
    plan-upgrade-ui:
        is_finished: false
        video_key: ~
    calculate-upgrade-cost:
        is_finished: false
        video_key: ~
    upgrade-upcoming-invoice-process:
        is_finished: false
        video_key: ~
    execute-plan-upgrade:
        is_finished: false
        video_key: ~
    plan-change-payment-failure:
        is_finished: false
        video_key: ~
    monthly-to-yearly:
        is_finished: false
        video_key: ~
    monthly-yearly-billing-period:
        is_finished: false
        video_key: ~
    coupon-code-form:
        is_finished: false
        video_key: ~
    validating-coupons:
        is_finished: false
        video_key: ~
    apply-coupon-checkout:
        is_finished: false
        video_key: ~
    free-checkout:
        is_finished: false
        video_key: ~
    sweet-invoices:
        is_finished: false
        video_key: ~
